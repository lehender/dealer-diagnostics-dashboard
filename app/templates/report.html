{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h1 class="h5 mb-0">Scan Report — {{ result["url"] }}</h1>
    <span class="badge bg-primary fs-6">Score: {{ result["score"] }}</span>
</div>

<div class="row g-3">
    {% set checks = result["checks"] %}
    {% for key, label in [("links","Links"), ("perf","Performance"), ("analytics","Analytics"), ("seo","SEO")] %}
    {% set c = checks[key] %}
    <div class="col-12 col-md-6">
        <div class="card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                    <h2 class="h6 mb-0">{{ label }}</h2>
                    {% if c["severity"] == "pass" %}
                    <span class="badge bg-success">PASS</span>
                    {% elif c["severity"] == "warn" %}
                    <span class="badge bg-warning text-dark">WARN</span>
                    {% else %}
                    <span class="badge bg-danger">FAIL</span>
                    {% endif %}
                </div>

                {% if "metrics" in c and c["metrics"] %}
                <ul class="mt-3 mb-2 small">
                    {% for k, v in c["metrics"].items() %}
                    <li><strong>{{ k }}</strong>: {{ v }}</li>
                    {% endfor %}
                </ul>
                {% endif %}

                {% if "items" in c and c["items"] %}
                <div class="small text-muted">
                    {% for it in c["items"] %}
                    <div>• {{ it if it is string else it | tojson }}</div>
                    {% endfor %}
                </div>
                {% endif %}

                {% if "suggestions" in c and c["suggestions"] %}
                <div class="mt-2 small">
                    <strong>Suggestions:</strong>
                    <ul class="mb-0">
                        {% for s in c["suggestions"] %}
                        <li>{{ s }}</li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<p class="text-muted small mt-3">
    Started: {{ result["started_at"] }} · Finished: {{ result["finished_at"] }} · Status: {{ result["status"] }}
</p>
{% endblock %}
